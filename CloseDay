function CloseDay() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var ТаблицаЛист_2 = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var ПоследняяСтрока = ТаблицаЛист_2.getLastRow();

  // выводим надпись Прибыль:

  var ПоследняяСтрока_2 = ТаблицаЛист_2.getLastRow();
  var ПрибыльЯчейка = ТаблицаЛист_2.getRange((ПоследняяСтрока_2 + 1), 5)
  ПрибыльЯчейка.setValue("Прибыль в сутки");
  
  // находим строку до которой нужно складывать столбцы:

  var столбец = 13; // по столбцу M
  var последняяСтрока = ТаблицаЛист_2.getLastRow();
  var диапазон = ТаблицаЛист_2.getRange(1, столбец, последняяСтрока, 1);
  var значения = диапазон.getValues();
  for (var i = последняяСтрока - 1; i >= 0; i--) 
  {
    if (значения[i][0] != "") {
      var последняяЯчейка = диапазон.getCell(i + 1, 1);
      var ПоследняяСтрокаF = i + 2;
      break;
    }
  }
  
  // находим прибыль (разность дохода и расхода):

  var ЯчейкаПрибыль = ТаблицаЛист_2.getRange((ПоследняяСтрока_2 + 1), 6)
  var ПрибыльФормула = '=SUMIF(E' + ПоследняяСтрокаF + ':E' + ПоследняяСтрока_2 + ';"Итого";F' + ПоследняяСтрокаF + ':F' + ПоследняяСтрока_2 + ')-SUMIF(E' + ПоследняяСтрокаF + ':E' + ПоследняяСтрока_2 + ';"Итого";G' + ПоследняяСтрокаF + ':G' + ПоследняяСтрока_2 + ')';
  ЯчейкаПрибыль.setFormula(ПрибыльФормула);

  // закрашиваем строку с прибылью в темно-серый цвет:

  var Темно_Серый = '#686868'; // Код цвета для темно-серого
  var ВсяСтрока = ТаблицаЛист_2.getRange((ПоследняяСтрока_2 + 1), 1, 1, 11);
  ВсяСтрока.setBackground(Темно_Серый);

  // закрашиваем ячейку Прибыль в зеленый цвет

  var Зеленый = '#2b811b'; // Код цвета для зеленый
  ЯчейкаПрибыль.setBackground(Зеленый);

  // делаем окантовку границ ячеек и сразу красим шрифт в белый и выделяем его жирным:

  // var ПоследняяСтрока_3 = ТаблицаЛист_2.getLastRow();
  // var ПоследнийСтолбец = ТаблицаЛист_2.getLastColumn();
  ВсяСтрока.setBorder(true, true, true, true, false, false, "white", SpreadsheetApp.BorderStyle.SOLID_THICK);
  var Границы = ТаблицаЛист_2.getRange((ПоследняяСтрока_2 + 1), 5, 1, 2);
  Границы.setBorder(true, true, true, true, true, true, "white", SpreadsheetApp.BorderStyle.SOLID_THICK); // Устанавливаем границы для диапазона ячеек
  Границы.setFontWeight("bold");
  var Белый = '#ffffff'; // Код цвета для белый
  Границы.setFontColor(Белый)

  // меняем формулы на значения:

  var ПоследняяСтрока_3 = ТаблицаЛист_2.getLastRow()
  var ДиапазонЗначений = ТаблицаЛист_2.getRange(ПоследняяСтрокаF, 6, ПоследняяСтрока_3, 11);
  ДиапазонЗначений.copyTo(ДиапазонЗначений, {contentsOnly:true});

  // удаляем ячейки с нулем:

  var dataRange = ТаблицаЛист_2.getRange("E6:E" + ПоследняяСтрока); // Указываем столбец, начиная с ячейки E5 и до конца
  var values = dataRange.getValues();
  var numRows = values.length;

  for (var i = numRows - 1; i >= 0; i--) {
    if (values[i][0] === "") {
      ТаблицаЛист_2.deleteRow(i + 6); // Удаляем строку на листе, учитывая смещение от E5
    }
  }
}
